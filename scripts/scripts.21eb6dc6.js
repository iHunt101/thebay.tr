"use strict";angular.module("bitCannonApp",["ngAnimate","ui.router","angular-loading-bar","angularMoment","infinite-scroll"]).config(["$stateProvider","$urlRouterProvider","$compileProvider",function(a,b,c){c.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension|magnet):/),b.otherwise("/"),a.state("index",{url:"/",templateUrl:"views/main.html",controller:"MainCtrl",pageTitle:"Home"}).state("browse",{url:"/browse",templateUrl:"views/browse.html",controller:"BrowseCtrl",pageTitle:"Browse"}).state("browseSearch",{url:"/browse/:category",templateUrl:"views/search.html",controller:"BrowsesearchCtrl",pageTitle:"Browse"}).state("search",{url:"/search/:query",templateUrl:"views/search.html",controller:"SearchCtrl",pageTitle:"Search"}).state("searchCategory",{url:"/search/:query/c/:category",templateUrl:"views/search.html",controller:"SearchCtrl",pageTitle:"Search"}).state("torrent",{url:"/torrent/:btih",templateUrl:"views/torrent.html",controller:"TorrentCtrl",pageTitle:"Torrent"}).state("about",{url:"/about",templateUrl:"views/about.html",controller:"MainCtrl",pageTitle:"About"})}]).run(["$rootScope","$window","$http",function(a,b,c){a.api="undefined"==typeof b.localStorage.api||""===b.localStorage.api?"":b.localStorage.api;var d=function(){c.get(a.api+"browse").success(function(b,c){200===c&&(a.categories=b)}).error(function(){}),c.get(a.api+"stats").success(function(b,c){if(200===c){a.stats=b,a.magnetTrackers="";for(var d=0;d<b.Trackers.length;++d)a.magnetTrackers=a.magnetTrackers+"&tr="+b.Trackers[d];a.magnetTrackers=a.magnetTrackers.replace(/\//g,"%2F"),a.magnetTrackers=a.magnetTrackers.replace(/:/g,"%3A")}else a.message=b.message}).error(function(){a.message="API Request failed."})};a.clearMessage=function(){a.message=null},d()}]),angular.module("bitCannonApp").controller("MainCtrl",["$scope","$state",function(a,b){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.submit=function(){a.query&&(a.selectedCategory?b.go("searchCategory",{query:a.query,category:a.selectedCategory.name}):b.go("search",{query:a.query}))}}]),angular.module("bitCannonApp").controller("SearchCtrl",["$rootScope","$scope","$stateParams","$http",function(a,b,c,d){b.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.query=c.query,b.category=c.category,b.results=[],"undefined"==typeof b.category||(b.query=b.query+"/c/"+b.category),b.busy=!1,b.infinite=function(){b.busy||(b.busy=!0,d.get(a.api+"search/"+b.query+"/s/"+b.results.length).success(function(c,d){if(200===d){0===c.length&&(b.infinite=function(){});for(var e=0;e<c.length;e++)b.results.push(c[e]);b.busy=!1}else b.busy=!1,a.message=c.message}).error(function(){b.busy=!1,a.message="API Request failed."}))}}]),angular.module("bitCannonApp").controller("TorrentCtrl",["$rootScope","$scope","$stateParams","$http",function(a,b,c,d){b.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.btih=c.btih;var e=function(){d.get(a.api+"torrent/"+b.btih).success(function(c,d){200===d?b.torrent=c:a.message=c.message}).error(function(){a.message="API Request failed."})};b.refreshing=!1,b.refresh=function(){return b.refreshing?void console.log("ignored duplicate refresh request"):(b.refreshing=!0,void d.get(a.api+"scrape/"+b.btih).success(function(c,d){200===d?(b.refreshing=!1,b.torrent.Swarm=c.Swarm,b.torrent.Lastmod=c.Lastmod):(b.refreshing=!1,a.message=c.message)}).error(function(){b.refreshing=!1,a.message="API Request failed."}))},e()}]),angular.module("bitCannonApp").controller("BrowseCtrl",["$rootScope","$scope",function(a,b){b.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("bitCannonApp").controller("BrowsesearchCtrl",["$rootScope","$scope","$stateParams","$http",function(a,b,c,d){b.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.category=c.category;var e=function(){d.get(a.api+"browse/"+b.category).success(function(c,d){200===d?b.results=c:a.message=c.message}).error(function(){a.message="API Request failed."})};e()}]),angular.module("bitCannonApp").controller("SettingsCtrl",["$rootScope","$scope","$window",function(a,b,c){b.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.saveAPI=function(){a.api=b.apiBox,c.localStorage.api=a.api},b.clearAPIBox=function(){b.apiBox=a.api},b.resetAPI=function(){delete c.localStorage.api,a.api="",b.apiBox=a.api},b.apiBox=a.api}]);